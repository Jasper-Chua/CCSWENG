<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width">
        <title>Basket</title>
        <link href="/css/style.css" rel="stylesheet" type="text/css" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    </head>

    <body class="mainBackground">
        <div class="header">
            <div class="logo">
                <img src="images/Logo.png" placeholder="G-Cakes Logo" alt="1">
            </div>

            <div class="menu">
                <button class="menuBtn">CAKES</button>
                <button class="menuBtn">CUPCAKES</button>
                <button class="menuBtn">DECORATED COOKIES</button>
                <button class="menuBtn">ABOUT</button>
                <button class="menuBtn"><img src="images/basket.png"></button>
            </div>
        </div>

        <div class="basketContainer">
            <div class="basketItemContainer">
                <%_ basketItemList.forEach(function(basketItem, index) { _%>
                <div class="basketItem">
                    <div class="basketItemImage">
                        <img src="images/cake1.jpg" placeholder="trial" alt="1">
                    </div>
                    
                    <!--
                    <div class="basketItemInfo">
                        <div class="basketNameContainer">
                            <h2>Birthday chocolate</h2>
                            <input type="hidden" name="productName" value="productName">
                        </div>
                        <div class="basketTypeContainer">
                            <h3>Type of Cake:</h3>
                            <select class="editFlavor" title="Flavor" id="flavor" name="flavor">
                                <option>Select Flavor</option>
                                
                            </select>
                            <select class="editSize" title="Size" id="size" name="size">
                                <option>Select Size</option>
                                
                            </select> 
                        </div>
                    </div>
                    
                    <div class="basketItemQuantity">
                        <div class="basketQuantityContainer">
                            <span id="decrement" class="incdec basketDecrement">-</span>
                            <input class="quantity basketQuantity" type="number" value="1">
                            <span id="increment" class="incdec basketIncrement">+</span>
                        </div>
                    </div>

                    <div class="basketGroupPriceNRemove">
                        <div class="basketItemPrice">
                            <h2>100000</h2>
                        </div>
                        <div class="basketItemRemove">
                            <button class="removeItem">Remove</button>
                        </div>
                    </div>
                    -->

                    <div class="basketItemInfo">
                        <div class="basketNameContainer">
                            <h2><%= productItemList[index].name %></h2>
                        </div>
                        <div class="basketTypeContainer">
                            <h3>Type of <%= productItemList[index].type %>:</h3>
                            <%_ if (productItemList[index].type != 'Cookie') { _%>
                            <select class="editFlavor" title="Flavor" id="flavor" name="flavor">  
                                <!-- Cake -->                              
                                <%_ if (basketItem.vanilla6x5Price > 0 || basketItem.vanilla8x5Price > 0) { _%>
                                    <option value="vanilla" <% if (productItemList[index].flavor == "vanilla") { %> selected <% } %>>Vanilla</option>
                                <%_ } _%>
                                <%_ if (basketItem.chocolate6x5Price > 0 || basketItem.chocolate8x5Price > 0) { _%>
                                    <option value="chocolate" <% if (productItemList[index].flavor == "chocolate") { %> selected <% } %>>Chocolate</option>
                                <%_ } _%>
                                <!-- Cupcake -->
                                <%_ if (basketItem.vanillaFondantPrice > 0 || basketItem.vanillaIcingPrice > 0) { _%>
                                    <option value="vanilla" <% if (productItemList[index].flavor == "vanilla") { %> selected <% } %>>Vanilla</option>
                                <%_ } _%>
                                <%_ if (basketItem.chocolateFondantPrice > 0 || basketItem.chocolateIcingPrice > 0) { _%>
                                    <option value="chocolate" <% if (productItemList[index].flavor == "chocolate") { %> selected <% } %>>Chocolate</option>
                                <%_ } _%>
                                <%_ if (basketItem.redvelvetFondantPrice > 0 || basketItem.redvelvetIcingPrice > 0) { _%>
                                    <option value="redVelvet" <% if (productItemList[index].flavor == "redVelvet") { %> selected <% } %>>Red Velvet</option>
                                <%_ } _%>
                            </select>
                            <%_ } _%>

                            <%_ if (productItemList[index].type == 'Cake') { _%>
                            <select class="editSize" title="Size" id="size" name="size">
                                <%_ if (basketItem.vanilla6x5Price > 0 || basketItem.chocolate6x5Price > 0) { _%>
                                    <option value="6x5" <% if (productItemList[index].size == "6x5") { %> selected <% } %>>6" x 5"</option>
                                <%_ } _%>
                                <%_ if (basketItem.vanilla8x5Price > 0 || basketItem.chocolate8x5Price > 0) { _%>
                                    <option value="8x5" <% if (productItemList[index].size == "8x5") { %> selected <% } %>>8" x 5"</option>
                                <%_ } _%>
                            </select> 
                            <%_ } _%>

                            <%_ if (productItemList[index].type == 'Cupcake') { _%>
                            <select id="displayProductFrosting" class="editFrosting" title="Frosting" name="frosting">
                                <%_ if (basketItem.vanillaFondantPrice > 0 || basketItem.chocolateFondantPrice > 0 || basketItem.redvelvetFondantPrice > 0) { _%>
                                    <option value="fondant" <% if (productItemList[index].flavor == "fondant") { %> selected <% } %>>Fondant</option>
                                <%_ } _%>
                                <%_ if (basketItem.vanillaIcingPrice > 0 || basketItem.chocolateIcingPrice > 0 || basketItem.redvelvetIcingPrice > 0) { _%>
                                    <option value="icing" <% if (productItemList[index].flavor == "icing") { %> selected <% } %>>Icing</option>
                                <%_ } _%>
                            </select>
                            <%_ } _%>
                        </div>
                    </div>
                    
                    <div class="basketItemQuantity">
                        <div class="basketQuantityContainer">
                            <span id="decrement" class="incdec basketDecrement">-</span>
                            <input class="quantity basketQuantity" type="number" value="<%= productItemList[index].quantity %>">
                            <span id="increment" class="incdec basketIncrement">+</span>
                        </div>
                    </div>

                    <div class="basketGroupPriceNRemove">
                        <div class="basketItemPrice">
                            <h2><%= productItemList[index].price %></h2>
                        </div>
                        <div class="basketItemButton">
                            <button class="updateItem">Update</button>
                            <button class="removeItem" value="<%= productItemList[index].itemNumber %>">Remove</button>
                        </div>
                    </div>

                    <input type="hidden" name="test" data="<%= productItemList[index] %>"/>
                </div>
                <%_ }) _%>
            </div>
            <div class="totalPriceContainer">
                <span class="totalPrice">Total: 1200</span>
                <button class="basketSubmit">CHECK OUT</button>
            </div>
        </div>
        <script>
            $(document).ready(function() {

                $(".removeItem").click(function() {
                    var itemNumber = $(this).val()

                    $.post('/removeBasketItem', {itemNumber: itemNumber}, function(result) {
                        alert(result)
                    })
                    $(this).parents('.basketItem').remove()
                })
            })
        </script>
    </body>

</html>